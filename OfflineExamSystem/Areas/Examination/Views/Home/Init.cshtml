@using System.Threading;
@model OfflineExamSystem.Areas.Examination.ViewModels.SessionViewModel
<div class="jumbotron">
    <h2> Offline Exam System</h2>
</div>

@if (TempData["message"] != null)
{
    <div class="row">
        <div class="col-md-10">
            <p>
                @Html.Raw(TempData["message"])
            </p>
        </div>
    </div>
}
<br /><br />
@using (Html.BeginForm("Router", "Home", FormMethod.Post))
{
    @Html.HiddenFor(m => m.UserName)
    @Html.HiddenFor(m => m.FullName_Ar)
    @Html.HiddenFor(m => m.FullName_En)
    <div class="container">
        <div class="row form-horizontal">

            <div class="form-group">
                <div class="col-md-3">@Html.Label(Resources.Resources.ExamMode)</div>
                <div class="col-md-5">
                    @if (Thread.CurrentThread.CurrentCulture.Name.Equals("en-US"))
                    {
                        @Html.DropDownList("ExamMode", new List<SelectListItem> { new SelectListItem { Text = "Simulation", Value = "false" }, new SelectListItem { Text = "Real", Value = "true" } }, Resources.Resources.ChooseExamMode, new { @class = "form-control" })

                    }
                    else
                    {
                        @Html.DropDownList("ExamMode", new List<SelectListItem> { new SelectListItem { Text = "محاكاة", Value = "false" }, new SelectListItem { Text = "حقيقي", Value = "true" } }, Resources.Resources.ChooseExamMode, new { @class = "form-control" })
                    }
                </div>
            </div>

            <div class="form-group">
                <div class="col-md-3">@Html.Label(Resources.Resources.ExamType)</div>
                <div class="col-md-5">
                        @Html.DropDownListFor(model => model.ExamId, null, Resources.Resources.ChooseExamType, htmlAttributes: new { @class = "form-control" })
                </div>
            </div>

            @*<div class="form-group">
                    <div class="col-md-3">@Html.Label("Complete from previous?")</div>
                    <div class="col-md-5">
                        @Html.CheckBox("Resume", false)
                    </div>
                </div>*@

            <div class="form-group">
                <div class="col-md-3"></div>
                <div class="col-md-5">
                    <a class="btn btn-primary" href="@Url.Action("Index","Home")">@Resources.Resources.Back</a>
                    <button type="submit" class="btn btn-primary">@Resources.Resources.Next >></button>
                </div>
            </div>

        </div>
    </div>
}
@section Scripts {
    <script type="text/javascript">
        $("#ExamId").empty();
        $(document).ready(function () {
            $("#ExamMode").change(function () {
                $.ajax({
                    type: 'POST',
                    url: '@Url.Action("GetExamsByExamMode")',
                    dataType: 'json',
                    data: { examMode: $("#ExamMode").val() },
                    success: function (Exams) {
                        $("#ExamId").empty();
                        $("#ExamId").append('<option value="' + -1 + '">@Resources.Resources.ChooseExamType</option>');
                        $.each(Exams, function (i, Exam) {
                            $("#ExamId").append('<option value="' + Exam.Value + '">' + Exam.Text + '</option>');
                        });
                    },
                    error: function (ex) {
                        if ($("#ExamMode").val()!="") {
                            alert('Failed to retrieve Exams.' + ex);
                        }
                    }
                });
                return false;
            })
        });
    </script>
}